<div class="approvals-container">
  <h1>Aprovações</h1>

  <div *ngIf="loading" class="loading">Carregando...</div>

  <div *ngIf="!loading && approvals.length > 0">
    <table class="table">
      <thead>
        <tr>
          <th>Release</th>
          <th>Status</th>
          <th>Resultado</th>
          <th>Criada em</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let approval of approvals">
          <td>{{ getReleaseVersion(approval.releaseId) }}</td>
          <td>
            <span [class]="'status-' + getOutcomeStatus(approval.outcome)">
              {{ getOutcomeStatus(approval.outcome) }}
            </span>
          </td>
          <td>{{ approval.outcome || '-' }}</td>
          <td>{{ approval.createdAt | date: 'short' }}</td>
          <td>
            <button 
              *ngIf="!approval.outcome"
              (click)="openApprovalModal(approval, 'approve')" 
              class="btn-approve">
              Aprovar
            </button>
            <button 
              *ngIf="!approval.outcome"
              (click)="openApprovalModal(approval, 'reject')" 
              class="btn-reject">
              Rejeitar
            </button>
            <span *ngIf="approval.outcome" class="status-done">✓ Respondido</span>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="pagination">
      <button (click)="previousPage()" [disabled]="skip === 0">← Anterior</button>
      <span>Página {{ (skip / limit) + 1 }}</span>
      <button (click)="nextPage()">Próxima →</button>
    </div>
  </div>

  <div *ngIf="!loading && approvals.length === 0" class="empty">
    Nenhuma aprovação
  </div>

  <!-- Modal para Aprovar/Rejeitar -->
  <div *ngIf="showModal" class="modal">
    <div class="modal-content">
      <h2>{{ modalMode === 'approve' ? 'Aprovar' : 'Rejeitar' }} Lançamento</h2>
      <form (ngSubmit)="submitApproval()">
        <div class="form-group">
          <label>Notas *</label>
          <textarea 
            [(ngModel)]="formData.notes" 
            name="notes" 
            [rows]="5"
            placeholder="Adicione seus comentários..."></textarea>
        </div>
        <div class="modal-actions">
          <button 
            type="submit" 
            [class]="modalMode === 'approve' ? 'btn-save' : 'btn-reject'">
            {{ modalMode === 'approve' ? 'Aprovar' : 'Rejeitar' }}
          </button>
          <button type="button" (click)="closeModal()" class="btn-cancel">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>
